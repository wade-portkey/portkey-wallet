var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.updateCustomChainItem=exports.updateChainListAction=exports.setCurrentChain=exports.resetNetwork=exports.removeCustomChainItem=exports.removeCommonList=exports.fetchChainListAsync=exports.addCustomChainItem=exports.addCommonList=exports.CustomChain=exports.CommonListAction=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _toolkit=require("@reduxjs/toolkit");var _api=require("./api");var _utils=require("./utils");var _contracts=require("../../contracts");var _types=require("./types");var setCurrentChain=exports.setCurrentChain=(0,_toolkit.createAction)('chain/setCurrentChain');var updateChainListAction=exports.updateChainListAction=(0,_toolkit.createAction)('chain/updateChainList');var addCommonList=exports.addCommonList=(0,_toolkit.createAction)('chain/addCommonList');var removeCommonList=exports.removeCommonList=(0,_toolkit.createAction)('chain/removeCommonList');var resetNetwork=exports.resetNetwork=(0,_toolkit.createAction)('chain/resetNetwork');var fetchChainListAsync=exports.fetchChainListAsync=(0,_toolkit.createAsyncThunk)('chain/fetchDefaultChainList',(0,_asyncToGenerator2.default)(function*(){var response=yield(0,_api.fetchChainList)();return response;}));var addCustomChainItem=exports.addCustomChainItem=(0,_toolkit.createAsyncThunk)('chain/addCustomChainItem',function(){var _ref2=(0,_asyncToGenerator2.default)(function*(chain){if(!chain.networkName)throw new Error(_types.ChainActionError.noName);if(!chain.chainId)throw new Error(_types.ChainActionError.noChainId);var key=chain.rpcUrl+"&"+chain.networkName;var isCustom=true;var nativeCurrency=chain.nativeCurrency;var basicContracts;if(chain.chainType==='aelf'){var chainStatus=yield(0,_utils.checkRpcUrlFormat)(chain);if(!nativeCurrency){try{var tokenAddress=yield(0,_contracts.getELFTokenAddress)(chain.rpcUrl,chainStatus.GenesisContractAddress);nativeCurrency={id:'',name:'ELF',symbol:'ELF',decimals:8,address:tokenAddress};basicContracts={tokenContract:tokenAddress};}catch(error){throw new Error(_types.ChainActionError.InvalidRpcUrl);}}}else{throw Error('Not Support');}return Object.assign(Object.assign({},chain,{networkName:chain.networkName.trim(),key:key,isCustom:isCustom}),{nativeCurrency:nativeCurrency,basicContracts:basicContracts});});return function(_x){return _ref2.apply(this,arguments);};}());var removeCustomChainItem=exports.removeCustomChainItem=(0,_toolkit.createAction)('chain/removeCustomChainItem');var updateCustomChainItem=exports.updateCustomChainItem=(0,_toolkit.createAsyncThunk)('chain/updateCustomChainItem',function(){var _ref3=(0,_asyncToGenerator2.default)(function*(chain){yield(0,_utils.checkRpcUrlFormat)(chain);return chain;});return function(_x2){return _ref3.apply(this,arguments);};}());var CustomChain=exports.CustomChain=function(){function CustomChain(){(0,_classCallCheck2.default)(this,CustomChain);}(0,_createClass2.default)(CustomChain,null,[{key:"add",value:function add(chain){return function(){var _ref4=(0,_asyncToGenerator2.default)(function*(dispatch){yield dispatch(addCustomChainItem(chain));});return function(_x3){return _ref4.apply(this,arguments);};}();}},{key:"remove",value:function remove(chain){return function(dispatch){dispatch(removeCustomChainItem(chain));};}},{key:"update",value:function update(chain){return function(dispatch){dispatch(updateCustomChainItem(chain));};}}]);return CustomChain;}();var CommonListAction=exports.CommonListAction=function(){function CommonListAction(){(0,_classCallCheck2.default)(this,CommonListAction);}(0,_createClass2.default)(CommonListAction,null,[{key:"add",value:function add(p){return addCommonList(p);}},{key:"remove",value:function remove(p){return removeCommonList(p);}}]);return CommonListAction;}();