var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.resetRecent=exports.recentSlice=exports.initialState=exports.initCurrentChainRecentData=exports.fetchRecentListAsync=exports.default=void 0;var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _toolkit=require("@reduxjs/toolkit");var _api=require("./api");var _useRecent=require("../../../hooks/hooks-ca/useRecent");var _recent=require("../../../constants/constants-ca/recent");var initialState=exports.initialState={};var fetchRecentListAsync=exports.fetchRecentListAsync=(0,_toolkit.createAsyncThunk)('fetchRecentListAsync',function(){var _ref3=(0,_asyncToGenerator2.default)(function*(_ref,_ref2){var caAddress=_ref.caAddress,caAddressInfos=_ref.caAddressInfos,_ref$isFirstTime=_ref.isFirstTime,isFirstTime=_ref$isFirstTime===void 0?true:_ref$isFirstTime;var getState=_ref2.getState;var _ref4=getState(),recent=_ref4.recent;var _ref5=(recent==null?void 0:recent[caAddress])||{},_ref5$skipCount=_ref5.skipCount,skipCount=_ref5$skipCount===void 0?0:_ref5$skipCount;var response=yield(0,_api.fetchRecentTransactionUsers)({caAddresses:[caAddress],caAddressInfos:caAddressInfos,skipCount:isFirstTime?0:skipCount,maxResultCount:_recent.RECENT_LIST_PAGE_SIZE});return{isFirstTime:isFirstTime,caAddress:caAddress,response:response};});return function(_x,_x2){return _ref3.apply(this,arguments);};}());var recentSlice=exports.recentSlice=(0,_toolkit.createSlice)({name:'recent',initialState:initialState,reducers:{initCurrentChainRecentData:function initCurrentChainRecentData(state,action){var caAddress=action.payload.caAddress;state[caAddress]=_useRecent.initialRecentData;},resetRecent:function resetRecent(){return initialState;}},extraReducers:function extraReducers(builder){builder.addCase(fetchRecentListAsync.fulfilled,function(state,action){var _state$caAddress;var _action$payload=action.payload,caAddress=_action$payload.caAddress,isFirstTime=_action$payload.isFirstTime,response=_action$payload.response;var targetData=(_state$caAddress=state==null?void 0:state[caAddress])!=null?_state$caAddress:{};targetData.isFetching=false;targetData.totalRecordCount=response==null?void 0:response.totalRecordCount;targetData.skipCount+=_recent.RECENT_LIST_PAGE_SIZE;if(isFirstTime){targetData.skipCount=_recent.RECENT_LIST_PAGE_SIZE;targetData.recentContactList=response.data;}else{targetData.recentContactList=[].concat((0,_toConsumableArray2.default)(targetData.recentContactList),(0,_toConsumableArray2.default)(response.data));}state[caAddress]=targetData;});}});var _recentSlice$actions=recentSlice.actions,resetRecent=exports.resetRecent=_recentSlice$actions.resetRecent,initCurrentChainRecentData=exports.initCurrentChainRecentData=_recentSlice$actions.initCurrentChainRecentData;var _default=exports.default=recentSlice;