var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.checkIsLastLoginAccount=checkIsLastLoginAccount;exports.getApprovalCount=getApprovalCount;exports.handleUserGuardiansList=handleUserGuardiansList;exports.handleVerificationDoc=handleVerificationDoc;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _misc=require("../constants/misc");var _wallet=require("../types/types-ca/wallet");var _bignumber=_interopRequireDefault(require("bignumber.js"));var APPROVAL_COUNT=_misc.ZERO.plus(3).div(5);function getApprovalCount(length){if(length<=3)return length;return APPROVAL_COUNT.times(length).dp(0,_bignumber.default.ROUND_DOWN).plus(1).toNumber();}function handleVerificationDoc(verificationDoc){var _verificationDoc$spli=verificationDoc.split(','),_verificationDoc$spli2=(0,_slicedToArray2.default)(_verificationDoc$spli,5),type=_verificationDoc$spli2[0],guardianIdentifier=_verificationDoc$spli2[1],verificationTime=_verificationDoc$spli2[2],verifierAddress=_verificationDoc$spli2[3],salt=_verificationDoc$spli2[4];return{type:type,guardianIdentifier:guardianIdentifier,verificationTime:verificationTime,verifierAddress:verifierAddress,salt:salt};}function handleUserGuardiansList(holderInfo,verifierServers){var guardianList=holderInfo.guardianList;return guardianList.guardians.map(function(item){return Object.assign({},item,{guardianAccount:item.guardianIdentifier||item.identifierHash,guardianType:_wallet.LoginType[item.type],key:item.guardianIdentifier+"&"+item.verifierId,verifier:Array.isArray(verifierServers)?verifierServers.find(function(verifierItem){return verifierItem.id===item.verifierId;}):verifierServers[item.verifierId],isLoginAccount:item.isLoginGuardian});});}function checkIsLastLoginAccount(guardiansList,guardian){var loginIndex=guardiansList.findIndex(function(item){var _item$verifier,_guardian$verifier;return item.isLoginAccount&&!(item.guardianType===guardian.guardianType&&item.guardianAccount===guardian.guardianAccount&&((_item$verifier=item.verifier)==null?void 0:_item$verifier.id)===((_guardian$verifier=guardian.verifier)==null?void 0:_guardian$verifier.id));});return loginIndex===-1;}