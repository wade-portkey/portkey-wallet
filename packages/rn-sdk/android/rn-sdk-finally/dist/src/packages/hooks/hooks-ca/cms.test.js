var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var networkHook=_interopRequireWildcard(require("./network"));var cmsStore=_interopRequireWildcard(require("packages/types/store-ca/cms/actions"));var _cms=require("./cms");var indexHook=_interopRequireWildcard(require("./.."));var _networkState=require("test/data/networkState");var _setup=require("test/utils/setup");var _render=require("test/utils/render");var _cmsState=require("test/data/cmsState");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n.default=e,t&&t.set(e,n),n;}var dispatchMock=jest.fn();jest.spyOn(indexHook,'useAppCommonDispatch').mockReturnValue(dispatchMock);jest.spyOn(cmsStore,'getDiscoverGroupAsync').mockReturnValue(dispatchMock);jest.spyOn(cmsStore,'getSocialMediaAsync').mockReturnValue(dispatchMock);describe('useCMS',function(){test('get cms data successfully',function(){var _renderHookWithProvid=(0,_render.renderHookWithProvider)(_cms.useCMS,(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid.result;expect(result.current).toHaveProperty('socialMediaListNetMap');expect(result.current).toHaveProperty('discoverGroupListNetMap');expect(result.current).toHaveProperty('tabMenuListNetMap');});test('failed to get cms data',function(){var _renderHookWithProvid2=(0,_render.renderHookWithProvider)(_cms.useCMS,(0,_setup.setupStore)({})),result=_renderHookWithProvid2.result;expect(result.current).toBeUndefined();});});describe('useSocialMediaList',function(){beforeEach(function(){jest.clearAllMocks();jest.restoreAllMocks();});it('should return social media list when isInit is false',function(){jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(networkHook,'useNetworkList').mockReturnValue([_networkState.TestnetNetworkInfo,_networkState.MainnetNetworkInfo]);var _renderHookWithProvid3=(0,_render.renderHookWithProvider)(_cms.useSocialMediaList,(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid3.result;expect(result.current).toEqual(_cmsState.CmsState.cms.socialMediaListNetMap.TESTNET);});it('should return social media list when isInit is true',function(){jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(networkHook,'useNetworkList').mockReturnValue([_networkState.TestnetNetworkInfo,_networkState.MainnetNetworkInfo]);var _renderHookWithProvid4=(0,_render.renderHookWithProvider)(function(){return(0,_cms.useSocialMediaList)(true);},(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid4.result;expect(result.current).toEqual(_cmsState.CmsState.cms.socialMediaListNetMap.TESTNET);});it('should return [] when cms.socialMediaListNetMap state is empty',function(){jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(networkHook,'useNetworkList').mockReturnValue([_networkState.TestnetNetworkInfo,_networkState.MainnetNetworkInfo]);var _renderHookWithProvid5=(0,_render.renderHookWithProvider)(function(){return(0,_cms.useSocialMediaList)(true);},(0,_setup.setupStore)({cms:{socialMediaListNetMap:[]}})),result=_renderHookWithProvid5.result;expect(result.current).toEqual([]);});});describe('useDiscoverGroupList',function(){beforeEach(function(){jest.clearAllMocks();jest.restoreAllMocks();});it('should return discover group list when isInit is false',function(){jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(networkHook,'useNetworkList').mockReturnValue([_networkState.TestnetNetworkInfo,_networkState.MainnetNetworkInfo]);var _renderHookWithProvid6=(0,_render.renderHookWithProvider)(_cms.useDiscoverGroupList,(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid6.result;expect(result.current).toEqual(_cmsState.CmsState.cms.discoverGroupListNetMap.TESTNET);});it('should return discover group list when isInit is true',function(){jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(networkHook,'useNetworkList').mockReturnValue([_networkState.TestnetNetworkInfo,_networkState.MainnetNetworkInfo]);var _renderHookWithProvid7=(0,_render.renderHookWithProvider)(function(){return(0,_cms.useDiscoverGroupList)(true);},(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid7.result;expect(result.current).toEqual(_cmsState.CmsState.cms.discoverGroupListNetMap.TESTNET);});it('should return [] when cms.discoverGroupListNetMap state is empty',function(){jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(networkHook,'useNetworkList').mockReturnValue([_networkState.TestnetNetworkInfo,_networkState.MainnetNetworkInfo]);var _renderHookWithProvid8=(0,_render.renderHookWithProvider)(function(){return(0,_cms.useDiscoverGroupList)(true);},(0,_setup.setupStore)({cms:{discoverGroupListNetMap:[]}})),result=_renderHookWithProvid8.result;expect(result.current).toEqual([]);});});describe('useBuyButton',function(){beforeEach(function(){jest.clearAllMocks();jest.restoreAllMocks();});it('should return buy button info when isInit is false',function(){var _CmsState$cms$buyButt;jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(networkHook,'useNetworkList').mockReturnValue([_networkState.TestnetNetworkInfo,_networkState.MainnetNetworkInfo]);var _renderHookWithProvid9=(0,_render.renderHookWithProvider)(_cms.useBuyButton,(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid9.result;expect(result.current).toEqual((_CmsState$cms$buyButt=_cmsState.CmsState.cms.buyButtonNetMap)==null?void 0:_CmsState$cms$buyButt.TESTNET);});it('should return buy button info when isInit is true',function(){var _CmsState$cms$buyButt2;jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(networkHook,'useNetworkList').mockReturnValue([_networkState.TestnetNetworkInfo,_networkState.MainnetNetworkInfo]);var _renderHookWithProvid10=(0,_render.renderHookWithProvider)(function(){return(0,_cms.useBuyButton)(true);},(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid10.result;expect(result.current).toEqual((_CmsState$cms$buyButt2=_cmsState.CmsState.cms.buyButtonNetMap)==null?void 0:_CmsState$cms$buyButt2.TESTNET);});it('should return undefined when cms.buyButtonNetMap state is empty',function(){jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(networkHook,'useNetworkList').mockReturnValue([_networkState.TestnetNetworkInfo,_networkState.MainnetNetworkInfo]);var _renderHookWithProvid11=(0,_render.renderHookWithProvider)(function(){return(0,_cms.useBuyButton)(true);},(0,_setup.setupStore)({cms:{buyButtonNetMap:{}}})),result=_renderHookWithProvid11.result;expect(result.current).toBeUndefined();});});describe('useBuyButtonShow',function(){beforeEach(function(){jest.clearAllMocks();jest.restoreAllMocks();});it('should return buy button info when testnet',(0,_asyncToGenerator2.default)(function*(){var _result$current;jest.spyOn(networkHook,'useIsMainnet').mockReturnValue(false);jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);var _renderHookWithProvid12=(0,_render.renderHookWithProvider)(_cms.useBuyButtonShow,(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid12.result;expect(result.current).toHaveProperty('isBuyButtonShow',false);expect(result.current).toHaveProperty('isBuySectionShow',false);expect(result.current).toHaveProperty('isSellSectionShow',false);expect(result.current).toHaveProperty('refreshBuyButton');var res=yield(_result$current=result.current)==null?void 0:_result$current.refreshBuyButton();jest.spyOn(cmsStore,'getBuyButtonAsync').mockReturnValue(function(){return{payload:{buyButtonNetMap:_cmsState.CmsState.cms.buyButtonNetMap}};});expect(res).toHaveProperty('isBuySectionShow',false);expect(res).toHaveProperty('isSellSectionShow',false);}));it('should return buy button info when opened buy on mainnet',(0,_asyncToGenerator2.default)(function*(){var _result$current2;jest.spyOn(networkHook,'useIsMainnet').mockReturnValue(true);jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.MainnetNetworkInfo);var _renderHookWithProvid13=(0,_render.renderHookWithProvider)(_cms.useBuyButtonShow,(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid13.result;expect(result.current).toHaveProperty('isBuyButtonShow',true);expect(result.current).toHaveProperty('isBuySectionShow',true);expect(result.current).toHaveProperty('isSellSectionShow',true);expect(result.current).toHaveProperty('refreshBuyButton');jest.spyOn(cmsStore,'getBuyButtonAsync').mockReturnValue(function(){return{payload:{buyButtonNetMap:_cmsState.CmsState.cms.buyButtonNetMap}};});var res=yield(_result$current2=result.current)==null?void 0:_result$current2.refreshBuyButton();expect(res).toHaveProperty('isBuySectionShow',true);expect(res).toHaveProperty('isSellSectionShow',true);}));it('should return error buy button info when closed buy on mainnet ',(0,_asyncToGenerator2.default)(function*(){var _result$current3;jest.spyOn(networkHook,'useIsMainnet').mockReturnValue(true);jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.MainnetNetworkInfo);var buyButtonNetMap={MAIN:{isBuySectionShow:false,isSellSectionShow:false},TESTNET:{isBuySectionShow:false,isSellSectionShow:false}};var _renderHookWithProvid14=(0,_render.renderHookWithProvider)(_cms.useBuyButtonShow,(0,_setup.setupStore)({cms:{buyButtonNetMap:buyButtonNetMap}})),result=_renderHookWithProvid14.result;expect(result.current).toHaveProperty('isBuyButtonShow',false);expect(result.current).toHaveProperty('isBuySectionShow',false);expect(result.current).toHaveProperty('isSellSectionShow',false);expect(result.current).toHaveProperty('refreshBuyButton');jest.spyOn(cmsStore,'getBuyButtonAsync').mockReturnValue(dispatchMock);var res=yield(_result$current3=result.current)==null?void 0:_result$current3.refreshBuyButton();expect(res).toHaveProperty('isBuySectionShow',false);expect(res).toHaveProperty('isSellSectionShow',false);}));});describe('useRememberMeBlackList',function(){beforeEach(function(){jest.clearAllMocks();jest.restoreAllMocks();});it('should return buy button info when testnet',(0,_asyncToGenerator2.default)(function*(){var _result$current4;jest.spyOn(networkHook,'useIsMainnet').mockReturnValue(false);jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);var _renderHookWithProvid15=(0,_render.renderHookWithProvider)(_cms.useBuyButtonShow,(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid15.result;expect(result.current).toHaveProperty('isBuyButtonShow',false);expect(result.current).toHaveProperty('isBuySectionShow',false);expect(result.current).toHaveProperty('isSellSectionShow',false);expect(result.current).toHaveProperty('refreshBuyButton');var res=yield(_result$current4=result.current)==null?void 0:_result$current4.refreshBuyButton();jest.spyOn(cmsStore,'getBuyButtonAsync').mockReturnValue(function(){return{payload:{buyButtonNetMap:_cmsState.CmsState.cms.buyButtonNetMap}};});expect(res).toHaveProperty('isBuySectionShow',false);expect(res).toHaveProperty('isSellSectionShow',false);}));it('should return buy button info when opened buy on mainnet',(0,_asyncToGenerator2.default)(function*(){var _result$current5;jest.spyOn(networkHook,'useIsMainnet').mockReturnValue(true);jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.MainnetNetworkInfo);var _renderHookWithProvid16=(0,_render.renderHookWithProvider)(_cms.useBuyButtonShow,(0,_setup.setupStore)(_cmsState.CmsState)),result=_renderHookWithProvid16.result;expect(result.current).toHaveProperty('isBuyButtonShow',true);expect(result.current).toHaveProperty('isBuySectionShow',true);expect(result.current).toHaveProperty('isSellSectionShow',true);expect(result.current).toHaveProperty('refreshBuyButton');jest.spyOn(cmsStore,'getBuyButtonAsync').mockReturnValue(function(){return{payload:{buyButtonNetMap:_cmsState.CmsState.cms.buyButtonNetMap}};});var res=yield(_result$current5=result.current)==null?void 0:_result$current5.refreshBuyButton();expect(res).toHaveProperty('isBuySectionShow',true);expect(res).toHaveProperty('isSellSectionShow',true);}));it('should return error buy button info when closed buy on mainnet ',(0,_asyncToGenerator2.default)(function*(){var _result$current6;jest.spyOn(networkHook,'useIsMainnet').mockReturnValue(true);jest.spyOn(networkHook,'useCurrentNetworkInfo').mockReturnValue(_networkState.MainnetNetworkInfo);var buyButtonNetMap={MAIN:{isBuySectionShow:false,isSellSectionShow:false},TESTNET:{isBuySectionShow:false,isSellSectionShow:false}};var _renderHookWithProvid17=(0,_render.renderHookWithProvider)(_cms.useBuyButtonShow,(0,_setup.setupStore)({cms:{buyButtonNetMap:buyButtonNetMap}})),result=_renderHookWithProvid17.result;expect(result.current).toHaveProperty('isBuyButtonShow',false);expect(result.current).toHaveProperty('isBuySectionShow',false);expect(result.current).toHaveProperty('isSellSectionShow',false);expect(result.current).toHaveProperty('refreshBuyButton');jest.spyOn(cmsStore,'getBuyButtonAsync').mockReturnValue(dispatchMock);var res=yield(_result$current6=result.current)==null?void 0:_result$current6.refreshBuyButton();expect(res).toHaveProperty('isBuySectionShow',false);expect(res).toHaveProperty('isSellSectionShow',false);}));});