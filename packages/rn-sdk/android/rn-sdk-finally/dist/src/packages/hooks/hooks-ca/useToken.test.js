var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _render=require("test/utils/render");var _setup=require("test/utils/setup");var _action=require("packages/types/store-ca/tokenManagement/action");var _useToken=require("./useToken");var _tokenManagementState=require("test/data/tokenManagementState");var baseHooks=_interopRequireWildcard(require("./.."));var networkHooks=_interopRequireWildcard(require("./network"));var _apiDid=require("../../api/api-did");var _networkState=require("test/data/networkState");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n.default=e,t&&t.set(e,n),n;}jest.mock('packages/types/store-ca/tokenManagement/action');jest.mock("../../api/api-did");beforeEach(function(){jest.restoreAllMocks();});describe('useToken',function(){beforeAll(function(){jest.useFakeTimers();});test('complete data, and return successfully',(0,_asyncToGenerator2.default)(function*(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref2=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x){return _ref2.apply(this,arguments);};}();});jest.spyOn(networkHooks,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.mocked(_action.fetchAllTokenListAsync).mockReturnValue({list:[{},{}],totalRecordCount:2});jest.mocked(_apiDid.request.token.displayUserToken).mockResolvedValue({});jest.spyOn(global,'setTimeout');var _renderHookWithProvid=(0,_render.renderHookWithProvider)(_useToken.useToken,(0,_setup.setupStore)(_tokenManagementState.TokenManagementState)),result=_renderHookWithProvid.result;expect(result.current[0]).toEqual(_tokenManagementState.TokenManagementState.tokenManagement);expect(result.current[1]).toHaveProperty('fetchTokenList');expect(result.current[1]).toHaveProperty('displayUserToken');yield result.current[1].fetchTokenList();expect(_action.fetchAllTokenListAsync).toHaveBeenCalled();var params={tokenItem:{address:'JRm...oAaE',chainId:'AELF',decimals:8,id:'217...2bad',isAdded:true,isDefault:false,name:'CPU',symbol:'CPU',tokenName:'CPU',userTokenId:'a0a...a6d4'},keyword:'',chainIdArray:['AELF','tDVV']};yield result.current[1].displayUserToken(params);jest.runAllTimers();expect(_apiDid.request.token.displayUserToken).toHaveBeenCalled();expect(setTimeout).toHaveBeenCalledTimes(1);expect(_action.fetchAllTokenListAsync).toHaveBeenCalledTimes(2);}));});describe('useMarketTokenListInCurrentChain',function(){test('get tokenManagement.tokenDataShowInMarket',function(){var _renderHookWithProvid2=(0,_render.renderHookWithProvider)(_useToken.useMarketTokenListInCurrentChain,(0,_setup.setupStore)(_tokenManagementState.TokenManagementState)),result=_renderHookWithProvid2.result;expect(result.current).toBe(_tokenManagementState.TokenManagementState.tokenManagement.tokenDataShowInMarket);});});describe('useIsFetchingTokenList',function(){test('get tokenManagement.isFetching',function(){var _renderHookWithProvid3=(0,_render.renderHookWithProvider)(_useToken.useIsFetchingTokenList,(0,_setup.setupStore)(_tokenManagementState.TokenManagementState)),result=_renderHookWithProvid3.result;expect(result.current).toBe(_tokenManagementState.TokenManagementState.tokenManagement.isFetching);});});describe('useFetchSymbolImages',function(){test('The getSymbolImagesAsync method is triggered successfully',function(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref3=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x2){return _ref3.apply(this,arguments);};}();});jest.mocked(_action.getSymbolImagesAsync).mockReturnValue('');(0,_render.renderHookWithProvider)(_useToken.useFetchSymbolImages,(0,_setup.setupStore)({}));expect(_action.getSymbolImagesAsync).toBeCalled();});});describe('useSymbolImages',function(){test('get tokenManagement.symbolImages',function(){var _renderHookWithProvid4=(0,_render.renderHookWithProvider)(_useToken.useSymbolImages,(0,_setup.setupStore)(_tokenManagementState.TokenManagementState)),result=_renderHookWithProvid4.result;expect(result.current).toBe(_tokenManagementState.TokenManagementState.tokenManagement.symbolImages);});});