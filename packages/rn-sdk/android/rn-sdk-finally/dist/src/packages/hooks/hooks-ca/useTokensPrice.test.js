var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _useTokensPrice=require("./useTokensPrice");var assetSlice=_interopRequireWildcard(require("packages/types/store-ca/assets/slice"));var baseHooks=_interopRequireWildcard(require("./.."));var _render=require("test/utils/render");var _setup=require("test/utils/setup");var _assetsState=require("test/data/assetsState");var networkHooks=_interopRequireWildcard(require("./network"));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n.default=e,t&&t.set(e,n),n;}describe('useGetCurrentAccountTokenPrice',function(){beforeEach(function(){jest.clearAllMocks();});test('complete data, and return successfully',function(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x){return _ref.apply(this,arguments);};}();});jest.spyOn(assetSlice,'fetchTokensPriceAsync').mockReturnValue({});var _renderHookWithProvid=(0,_render.renderHookWithProvider)(_useTokensPrice.useGetCurrentAccountTokenPrice,(0,_setup.setupStore)(_assetsState.AssetsState)),result=_renderHookWithProvid.result;expect(result.current[1]).toBeInstanceOf(Function);result.current[1]();expect(assetSlice.fetchTokensPriceAsync).toHaveBeenCalledTimes(1);});test('set ELF params, and return successfully',function(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref2=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x2){return _ref2.apply(this,arguments);};}();});jest.spyOn(assetSlice,'fetchTokensPriceAsync').mockReturnValue({});var _renderHookWithProvid2=(0,_render.renderHookWithProvider)(_useTokensPrice.useGetCurrentAccountTokenPrice,(0,_setup.setupStore)(_assetsState.AssetsState)),result=_renderHookWithProvid2.result;expect(result.current[1]).toBeInstanceOf(Function);result.current[1]('ELF');expect(assetSlice.fetchTokensPriceAsync).toHaveBeenCalledTimes(1);});test('no accountToken data, and do not call fetchTokensPriceAsync method',function(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref3=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x3){return _ref3.apply(this,arguments);};}();});var _renderHookWithProvid3=(0,_render.renderHookWithProvider)(_useTokensPrice.useGetCurrentAccountTokenPrice,(0,_setup.setupStore)({assets:Object.assign({},_assetsState.AssetsState.assets,{accountToken:[]})})),result=_renderHookWithProvid3.result;expect(result.current[1]).toBeInstanceOf(Function);result.current[1]();expect(assetSlice.fetchTokensPriceAsync).toHaveBeenCalledTimes(0);});test('set ELF params, and call getTokensPrice method',function(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref4=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x4){return _ref4.apply(this,arguments);};}();});var _renderHookWithProvid4=(0,_render.renderHookWithProvider)(_useTokensPrice.useGetCurrentAccountTokenPrice,(0,_setup.setupStore)({assets:Object.assign({},_assetsState.AssetsState.assets,{accountToken:[]})})),result=_renderHookWithProvid4.result;expect(result.current[2]).toBeInstanceOf(Function);result.current[2]();expect(assetSlice.fetchTokensPriceAsync).toHaveBeenCalledTimes(1);});});describe('useFreshTokenPrice',function(){beforeEach(function(){jest.clearAllMocks();});test('Mainnet, and fetchTokensPriceAsync method is called',function(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref5=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x5){return _ref5.apply(this,arguments);};}();});jest.spyOn(assetSlice,'fetchTokensPriceAsync').mockReturnValue({});jest.spyOn(networkHooks,'useIsMainnet').mockReturnValue(true);(0,_render.renderHookWithProvider)(_useTokensPrice.useFreshTokenPrice,(0,_setup.setupStore)(_assetsState.AssetsState));expect(assetSlice.fetchTokensPriceAsync).toBeCalledTimes(1);});test('Testnet, and fetchTokensPriceAsync method is not called',function(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref6=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x6){return _ref6.apply(this,arguments);};}();});jest.spyOn(networkHooks,'useIsMainnet').mockReturnValue(false);(0,_render.renderHookWithProvider)(_useTokensPrice.useFreshTokenPrice,(0,_setup.setupStore)({assets:Object.assign({},_assetsState.AssetsState.assets,{accountToken:[]})}));expect(assetSlice.fetchTokensPriceAsync).toBeCalledTimes(0);});});describe('useAmountInUsdShow',function(){test('ELF price is 0.294964, and return successful usd',function(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref7=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x7){return _ref7.apply(this,arguments);};}();});jest.spyOn(assetSlice,'fetchTokensPriceAsync').mockReturnValue({});var _renderHookWithProvid5=(0,_render.renderHookWithProvider)(_useTokensPrice.useAmountInUsdShow,(0,_setup.setupStore)(_assetsState.AssetsState)),result=_renderHookWithProvid5.result;var res=result.current(100,0,'ELF');expect(res).toEqual('$ 29.49');});test('ELF price is 0, and return empty string',function(){jest.spyOn(baseHooks,'useAppCommonDispatch').mockReturnValue(function(){return function(){var _ref8=(0,_asyncToGenerator2.default)(function*(call){return call;});return function(_x8){return _ref8.apply(this,arguments);};}();});jest.spyOn(assetSlice,'fetchTokensPriceAsync').mockReturnValue({});var _renderHookWithProvid6=(0,_render.renderHookWithProvider)(_useTokensPrice.useAmountInUsdShow,(0,_setup.setupStore)({assets:Object.assign({},_assetsState.AssetsState.assets,{tokenPrices:{isFetching:false,tokenPriceObject:{ELF:0}}})})),result=_renderHookWithProvid6.result;var res=result.current(100,0,'ELF');expect(res).toEqual('');});});describe('useIsTokenHasPrice',function(){test('complete data, and return successfully',function(){var _renderHookWithProvid7=(0,_render.renderHookWithProvider)(_useTokensPrice.useIsTokenHasPrice,(0,_setup.setupStore)(_assetsState.AssetsState)),result=_renderHookWithProvid7.result;expect(result.current).toBeFalsy();});test('complete data, and return successfully',function(){var _renderHookWithProvid8=(0,_render.renderHookWithProvider)(function(){return(0,_useTokensPrice.useIsTokenHasPrice)('ETH');},(0,_setup.setupStore)(_assetsState.AssetsState)),result=_renderHookWithProvid8.result;expect(result.current).toBeFalsy();});test('complete data, and return successfully',function(){var _renderHookWithProvid9=(0,_render.renderHookWithProvider)(function(){return(0,_useTokensPrice.useIsTokenHasPrice)('ELF');},(0,_setup.setupStore)(_assetsState.AssetsState)),result=_renderHookWithProvid9.result;expect(result.current).toBeTruthy();});});