Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.addressBookSlice=void 0;var _toolkit=require("@reduxjs/toolkit");var _utils=require("../../utils");var _types=require("./types");var initialState={addressBook:{}};var addressBookSlice=exports.addressBookSlice=(0,_toolkit.createSlice)({name:'addressBook',initialState:initialState,reducers:{updateCurrentChainAddressBook:function updateCurrentChainAddressBook(state,action){var _state$addressBook,_state$addressBook2,_state$addressBook3,_state$addressBook4,_state$addressBook5;var _action$payload=action.payload,addressBook=_action$payload.addressBook,type=_action$payload.type,currentChain=_action$payload.currentChain;var rpcUrl=currentChain.rpcUrl,networkName=currentChain.networkName;var address=(0,_utils.addressFormat)(addressBook.address,currentChain.chainId,currentChain.chainType);var error=[];if(!(0,_utils.isAddress)(address!=null?address:'',currentChain.chainType))error.push(_types.AddressBookError.invalidAddress);var addressBookFormat={name:addressBook.name.trim(),key:addressBook.key?addressBook.key:address+"&"+addressBook.name,address:address};if(!addressBookFormat.name)error.push(_types.AddressBookError.noName);var flag;switch(type){case'add':flag=((_state$addressBook=state.addressBook[rpcUrl+"&"+networkName])!=null?_state$addressBook:[]).some(function(item){return item.name===addressBook.name.trim();});if(flag)error.push(_types.AddressBookError.alreadyExists);if(error.length)throw new Error(JSON.stringify(error));state.addressBook[rpcUrl+"&"+networkName]=((_state$addressBook2=state.addressBook[rpcUrl+"&"+networkName])!=null?_state$addressBook2:[]).concat([addressBookFormat]);break;case'remove':state.addressBook[rpcUrl+"&"+networkName]=((_state$addressBook3=state.addressBook[rpcUrl+"&"+networkName])!=null?_state$addressBook3:[]).filter(function(item){return item.key!==addressBookFormat.key;});break;case'update':flag=((_state$addressBook4=state.addressBook[rpcUrl+"&"+networkName])!=null?_state$addressBook4:[]).some(function(item){return item.name===addressBook.name.trim()&&item.key!==(addressBook==null?void 0:addressBook.key);});if(flag)error.push(_types.AddressBookError.alreadyExists);if(error.length)throw new Error(JSON.stringify(error));state.addressBook[rpcUrl+"&"+networkName]=((_state$addressBook5=state.addressBook[rpcUrl+"&"+networkName])!=null?_state$addressBook5:[]).map(function(item){return item.key===addressBookFormat.key?addressBookFormat:item;});break;default:throw'update error';}},resetAddressBook:function resetAddressBook(){return initialState;}}});var _default=exports.default=addressBookSlice;