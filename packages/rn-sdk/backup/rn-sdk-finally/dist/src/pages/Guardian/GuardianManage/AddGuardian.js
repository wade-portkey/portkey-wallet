var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _GStyles=_interopRequireDefault(require("../../../assets/theme/GStyles"));var _CommonText=require("../../../components/CommonText");var _Svg=_interopRequireDefault(require("../../../components/Svg"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _unit=require("../../../utils/unit");var _PageContainer=_interopRequireDefault(require("../../../components/PageContainer"));var _style=require("./style");var _ListItem=_interopRequireDefault(require("../../../components/ListItem"));var _hooks=require("../../../i18n/hooks");var _CommonInput=_interopRequireDefault(require("../../../components/CommonInput"));var _check=require("../../../packages/utils/check");var _misc=require("../../../constants/misc");var _guardian=require("../../../packages/constants/constants-ca/guardian");var _verifier=require("../../../packages/types/verifier");var _common=require("../../../constants/common");var _GuardianTypeSelectOverlay=_interopRequireDefault(require("../components/GuardianTypeSelectOverlay"));var _VerifierSelectOverlay=_interopRequireDefault(require("../components/VerifierSelectOverlay"));var _ActionSheet=_interopRequireDefault(require("../../../components/ActionSheet"));var _styles=require("../../../assets/theme/styles");var _Loading=_interopRequireDefault(require("../../../components/Loading"));var _CommonToast=_interopRequireDefault(require("../../../components/CommonToast"));var _wallet=require("../../../packages/types/types-ca/wallet");var _VerifierImage=require("../components/VerifierImage");var _fonts=_interopRequireDefault(require("../../../assets/theme/fonts"));var _PhoneInput=_interopRequireDefault(require("../../../components/PhoneInput"));var _Touchable=_interopRequireDefault(require("../../../components/Touchable"));var _apiDid=require("../../../packages/api/api-did");var _verification=_interopRequireDefault(require("../../../packages/api/api-did/verification"));var _authentication=require("../../../model/hooks/authentication");var _constants=require("../../../global/constants");var _useEffectOnce=_interopRequireDefault(require("../../../hooks/useEffectOnce"));var _handler=require("../../../model/contract/handler");var _controller=require("../../../network/controller");var _wallet2=require("../../../model/wallet");var _global=require("../../../model/global");var _UseBaseContainer=_interopRequireDefault(require("../../../model/container/UseBaseContainer"));var _entries=require("../../../config/entries");var _wallet3=require("../../../types/wallet");var _CommonButton=_interopRequireDefault(require("../../../components/CommonButton"));var _VerifyHumanMachine=require("../../../components/VerifyHumanMachine");var _hooks2=require("../../../model/verify/entry/hooks");var _core=require("../../../model/verify/core");var _socialRecovery=require("../../../model/verify/social-recovery");var _buffer=require("buffer");var _utils=require("../../../packages/utils");var _this=this,_jsxFileName="/Users/fengfeiyang/aelf/portkey-wallet/packages/rn-sdk/android/rn-sdk-finally/src/pages/Guardian/GuardianManage/AddGuardian.tsx";function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n.default=e,t&&t.set(e,n),n;}if(!global.Buffer){global.Buffer=_buffer.Buffer;}var AddGuardian=function AddGuardian(){var _useLanguage=(0,_hooks.useLanguage)(),t=_useLanguage.t;var _useState=(0,_react.useState)([]),_useState2=(0,_slicedToArray2.default)(_useState,2),userGuardiansList=_useState2[0],setUserGuardiansList=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=(0,_slicedToArray2.default)(_useState3,2),verifierMap=_useState4[0],setVerifierMap=_useState4[1];var verifierList=(0,_react.useMemo)(function(){return verifierMap?Object.values(verifierMap):[];},[verifierMap]);var _useState5=(0,_react.useState)(),_useState6=(0,_slicedToArray2.default)(_useState5,2),selectedType=_useState6[0],setSelectedType=_useState6[1];var _useState7=(0,_react.useState)(),_useState8=(0,_slicedToArray2.default)(_useState7,2),selectedVerifier=_useState8[0],setSelectedVerifier=_useState8[1];var _useState9=(0,_react.useState)(),_useState10=(0,_slicedToArray2.default)(_useState9,2),account=_useState10[0],setAccount=_useState10[1];var _useState11=(0,_react.useState)(Object.assign({},_common.INIT_HAS_ERROR)),_useState12=(0,_slicedToArray2.default)(_useState11,2),guardianTypeError=_useState12[0],setGuardianTypeError=_useState12[1];var _useState13=(0,_react.useState)(Object.assign({},_common.INIT_NONE_ERROR)),_useState14=(0,_slicedToArray2.default)(_useState13,2),guardianError=_useState14[0],setGuardianError=_useState14[1];var _useState15=(0,_react.useState)(_wallet3.defaultCountryCode),_useState16=(0,_slicedToArray2.default)(_useState15,2),country=_useState16[0],setCountry=_useState16[1];var _useState17=(0,_react.useState)(),_useState18=(0,_slicedToArray2.default)(_useState17,2),firstName=_useState18[0],setFirstName=_useState18[1];var _useBaseContainer=(0,_UseBaseContainer.default)({entryName:_entries.PortkeyEntries.ADD_GUARDIAN_ENTRY}),navigateForResult=_useBaseContainer.navigateForResult,onFinish=_useBaseContainer.onFinish;var checkMMKVStorage=function(){var _ref=(0,_asyncToGenerator2.default)(function*(){var countryDTO=yield(0,_global.getCachedCountryCodeData)();setCountry(countryDTO==null?void 0:countryDTO.locateData);});return function checkMMKVStorage(){return _ref.apply(this,arguments);};}();var _useAppleAuthenticati=(0,_authentication.useAppleAuthentication)(),appleSign=_useAppleAuthenticati.appleSign;var _useGoogleAuthenticat=(0,_authentication.useGoogleAuthentication)(),googleSign=_useGoogleAuthenticat.googleSign;var verifyToken=(0,_authentication.useVerifyToken)();var thirdPartyInfoRef=(0,_react.useRef)();(0,_useEffectOnce.default)((0,_asyncToGenerator2.default)(function*(){var _yield$getOrReadCache2,_yield$getOrReadCache3,_guardiansInfo$guardi,_guardiansInfo$guardi2;yield checkMMKVStorage();var _yield$getOrReadCache=yield(0,_handler.getOrReadCachedVerifierData)(),data=_yield$getOrReadCache.data;var _ref3=data||{},verifiers=_ref3.verifierServers;console.log('verifiers',JSON.stringify(verifiers));verifiers&&setVerifierMap(verifiers);var _yield$getUnlockedWal=yield(0,_wallet2.getUnlockedWallet)(),caHash=_yield$getUnlockedWal.caInfo.caHash;var chainId=yield _constants.PortkeyConfig.currChainId();var guardiansInfo=yield _controller.NetworkController.getGuardianInfo('',caHash);var cachedVerifierData=Object.values((_yield$getOrReadCache2=(_yield$getOrReadCache3=(yield(0,_handler.getOrReadCachedVerifierData)()).data)==null?void 0:_yield$getOrReadCache3.verifierServers)!=null?_yield$getOrReadCache2:{});var parsedGuardians=guardiansInfo==null?void 0:(_guardiansInfo$guardi=guardiansInfo.guardianList)==null?void 0:(_guardiansInfo$guardi2=_guardiansInfo$guardi.guardians)==null?void 0:_guardiansInfo$guardi2.map(function(guardian){return(0,_global.parseGuardianInfo)(guardian,chainId,cachedVerifierData,undefined,undefined,_core.AccountOriginalType.Email,_verifier.OperationTypeEnum.addGuardian);});console.log('guardians:',JSON.stringify(parsedGuardians));parsedGuardians&&setUserGuardiansList(parsedGuardians);}));var onAccountChange=(0,_react.useCallback)(function(value){setAccount(value);setGuardianTypeError(Object.assign({},_common.INIT_NONE_ERROR));},[]);var onChooseVerifier=(0,_react.useCallback)(function(item){setGuardianError(Object.assign({},_common.INIT_NONE_ERROR));setSelectedVerifier(item);},[]);var isConfirmDisable=(0,_react.useMemo)(function(){return!selectedVerifier||!selectedType||!account;},[account,selectedType,selectedVerifier]);var checkCurGuardianRepeat=(0,_react.useCallback)(function(){if(!selectedType){return Object.assign({},_common.INIT_HAS_ERROR);}if([_wallet.LoginType.Email,_wallet.LoginType.Phone].includes(selectedType.value)){var _account=account;if(selectedType.value===_wallet.LoginType.Phone){_account="+"+(country==null?void 0:country.code)+account;}if((userGuardiansList==null?void 0:userGuardiansList.findIndex(function(guardian){return(0,_global.guardianTypeStrToEnum)(guardian.sendVerifyCodeParams.type)===(selectedType==null?void 0:selectedType.value)&&guardian.sendVerifyCodeParams.guardianIdentifier===_account&&guardian.sendVerifyCodeParams.verifierId===(selectedVerifier==null?void 0:selectedVerifier.id);}))!==-1){return Object.assign({},_common.INIT_HAS_ERROR,{errorMsg:t('This guardian already exists')});}else{return Object.assign({},_common.INIT_NONE_ERROR);}}if([_wallet.LoginType.Apple,_wallet.LoginType.Google].includes(selectedType.value)){var _thirdPartyInfoRef$cu;var guardianAccount=(_thirdPartyInfoRef$cu=thirdPartyInfoRef.current)==null?void 0:_thirdPartyInfoRef$cu.id;if((userGuardiansList==null?void 0:userGuardiansList.findIndex(function(guardian){return(0,_global.guardianTypeStrToEnum)(guardian.sendVerifyCodeParams.type)===(selectedType==null?void 0:selectedType.value)&&guardian.sendVerifyCodeParams.guardianIdentifier===guardianAccount&&guardian.sendVerifyCodeParams.verifierId===(selectedVerifier==null?void 0:selectedVerifier.id);}))!==-1){return Object.assign({},_common.INIT_HAS_ERROR,{errorMsg:t('This guardian already exists')});}else{return Object.assign({},_common.INIT_NONE_ERROR);}}return Object.assign({},_common.INIT_NONE_ERROR);},[account,country==null?void 0:country.code,selectedType,selectedVerifier==null?void 0:selectedVerifier.id,t,userGuardiansList]);var thirdPartyConfirm=(0,_react.useCallback)(function(){var _ref4=(0,_asyncToGenerator2.default)(function*(guardianAccount,thirdPartyInfo,verifierInfo,guardianType){if(!selectedVerifier)return;var originalChainId=yield _constants.PortkeyConfig.currChainId();var rst=yield verifyToken(guardianType,{accessToken:thirdPartyInfo.accessToken,id:thirdPartyInfo.id,verifierId:verifierInfo.id,chainId:originalChainId,operationType:_verifier.OperationTypeEnum.addGuardian});_Loading.default.hide();if(!rst)throw new Error('verify fail');var thisGuardian={sendVerifyCodeParams:{type:(0,_global.guardianEnumToTypeStr)(guardianType),guardianIdentifier:guardianAccount||'',verifierId:selectedVerifier.id,chainId:originalChainId,operationType:_verifier.OperationTypeEnum.communityRecovery},alreadySent:true,accountIdentifier:'unknown',accountOriginalType:_core.AccountOriginalType.Email,isLoginGuardian:false,name:selectedVerifier.name,imageUrl:selectedVerifier.imageUrl,verifiedDoc:{verificationDoc:rst.verificationDoc,signature:rst.signature}};(0,_hooks2.handleGuardiansApproval)({guardianVerifyType:_socialRecovery.GuardianVerifyType.ADD_GUARDIAN,accountIdentifier:'',accountOriginalType:_core.AccountOriginalType.Email,guardians:userGuardiansList,particularGuardian:thisGuardian});});return function(_x,_x2,_x3,_x4){return _ref4.apply(this,arguments);};}(),[selectedVerifier,userGuardiansList,verifyToken]);var onConfirm=(0,_react.useCallback)((0,_asyncToGenerator2.default)(function*(){if(selectedVerifier===undefined||selectedType===undefined)return;var guardianType=selectedType.value;var guardianAccount=account;var showGuardianAccount;if(guardianType===_wallet.LoginType.Phone){guardianAccount="+"+(country==null?void 0:country.code)+account;showGuardianAccount="+"+(country==null?void 0:country.code)+" "+account;}if(guardianType===_wallet.LoginType.Email){var guardianErrorMsg=(0,_check.checkEmail)(account);if(guardianErrorMsg){setGuardianTypeError({isError:true,errorMsg:guardianErrorMsg});setGuardianError(Object.assign({},_common.INIT_NONE_ERROR));return;}}var _guardianError=checkCurGuardianRepeat();setGuardianError(_guardianError);if(_guardianError.isError)return;if([_wallet.LoginType.Apple,_wallet.LoginType.Google].includes(guardianType)){if(!thirdPartyInfoRef.current)return;try{_Loading.default.show();yield thirdPartyConfirm(guardianAccount||'',thirdPartyInfoRef.current,selectedVerifier,guardianType);}catch(error){_CommonToast.default.failError(error);}_Loading.default.hide();return;}_ActionSheet.default.alert({title2:_react.default.createElement(_reactNative.Text,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:273,columnNumber:9}},_react.default.createElement(_CommonText.TextL,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:274,columnNumber:11}},selectedVerifier.name+" will send a verification code to "),_react.default.createElement(_CommonText.TextL,{style:_fonts.default.mediumFont,__self:_this,__source:{fileName:_jsxFileName,lineNumber:275,columnNumber:11}},showGuardianAccount||guardianAccount),_react.default.createElement(_CommonText.TextL,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:276,columnNumber:11}}," to verify your "+(guardianType===_wallet.LoginType.Phone?'phone number':'email address')+".")),buttons:[{title:t('Cancel'),type:'outline'},{title:t('Confirm'),onPress:function(){var _onPress=(0,_asyncToGenerator2.default)(function*(){try{if([_wallet.LoginType.Email,_wallet.LoginType.Phone].includes(guardianType)){_Loading.default.show();var accountIdentifier=guardianAccount||'';var accountOriginalType=guardianType===_wallet.LoginType.Email?_core.AccountOriginalType.Email:_core.AccountOriginalType.Phone;var originalChainId=yield _constants.PortkeyConfig.currChainId();var needRecaptcha=yield _controller.NetworkController.isGoogleRecaptchaOpen(_verifier.OperationTypeEnum.addGuardian);var reCaptchaToken;if(needRecaptcha){reCaptchaToken=yield(0,_VerifyHumanMachine.verifyHumanMachine)('en');}var req=yield _controller.NetworkController.sendVerifyCode({type:(0,_global.guardianEnumToTypeStr)(guardianType),guardianIdentifier:guardianAccount||'',verifierId:selectedVerifier.id,chainId:originalChainId,operationType:_verifier.OperationTypeEnum.addGuardian},reCaptchaToken?{reCaptchaToken:reCaptchaToken}:{});if(req.verifierSessionId){var thisGuardian={sendVerifyCodeParams:{type:(0,_global.guardianEnumToTypeStr)(guardianType),guardianIdentifier:guardianAccount||'',verifierId:selectedVerifier.id,chainId:originalChainId,operationType:_verifier.OperationTypeEnum.addGuardian},alreadySent:true,accountIdentifier:accountIdentifier,verifySessionId:req.verifierSessionId,accountOriginalType:accountOriginalType,isLoginGuardian:false,name:selectedVerifier.name,imageUrl:selectedVerifier.imageUrl};var guardianVerifyResult=yield(0,_hooks2.handlePhoneOrEmailGuardianVerify)({verificationType:_verifier.VerificationType.addGuardian,accountIdentifier:accountIdentifier,accountOriginalType:accountOriginalType,deliveredGuardianInfo:JSON.stringify(thisGuardian),operationType:_verifier.OperationTypeEnum.addGuardian});if(!(guardianVerifyResult!=null&&guardianVerifyResult.verifiedData)){throw new Error('guardian is not verified!');}var verifiedData=JSON.parse(guardianVerifyResult.verifiedData);_Loading.default.show();yield(0,_utils.sleep)(500);_Loading.default.hide();yield(0,_utils.sleep)(200);(0,_hooks2.handleGuardiansApproval)({guardianVerifyType:_socialRecovery.GuardianVerifyType.ADD_GUARDIAN,accountIdentifier:accountIdentifier,accountOriginalType:accountOriginalType,guardians:userGuardiansList.map(function(it){it.accountIdentifier=accountIdentifier;it.sendVerifyCodeParams.operationType=_verifier.OperationTypeEnum.addGuardian;return it;}),particularGuardian:Object.assign({},thisGuardian,{verifiedDoc:verifiedData})});}else{throw new Error('send fail');}}}catch(error){_CommonToast.default.failError(error);console.error(error);}_Loading.default.hide();});function onPress(){return _onPress.apply(this,arguments);}return onPress;}()}]});}),[selectedVerifier,selectedType,account,checkCurGuardianRepeat,t,country==null?void 0:country.code,thirdPartyConfirm,userGuardiansList]);var onChooseType=(0,_react.useCallback)(function(_type){setSelectedType(_type);setAccount(undefined);setFirstName(undefined);thirdPartyInfoRef.current=undefined;setGuardianError(Object.assign({},_common.INIT_NONE_ERROR));},[]);var onAppleSign=(0,_react.useCallback)((0,_asyncToGenerator2.default)(function*(){_Loading.default.show();var userInfo;try{userInfo=yield appleSign();thirdPartyInfoRef.current={id:userInfo.user.id,accessToken:userInfo.identityToken||''};}catch(error){_CommonToast.default.failError(error);_Loading.default.hide();return;}_Loading.default.show();try{var appleUserExtraInfo=yield _apiDid.request.verify.getAppleUserExtraInfo({url:_verification.default.getAppleUserExtraInfo.target+"/"+userInfo.user.id});setFirstName(appleUserExtraInfo.firstName||undefined);if(appleUserExtraInfo.isPrivate){setAccount(_guardian.PRIVATE_GUARDIAN_ACCOUNT);}else{setAccount(appleUserExtraInfo.email||_guardian.PRIVATE_GUARDIAN_ACCOUNT);}}catch(error){var _userInfo$fullName;if(!userInfo)return;setFirstName(((_userInfo$fullName=userInfo.fullName)==null?void 0:_userInfo$fullName.givenName)||undefined);if(userInfo.user.isPrivate){setAccount(_guardian.PRIVATE_GUARDIAN_ACCOUNT);}else{setAccount(userInfo.user.email);}}_Loading.default.hide();}),[appleSign]);var onGoogleSign=(0,_react.useCallback)((0,_asyncToGenerator2.default)(function*(){_Loading.default.show();try{var userInfo=yield googleSign();setAccount(userInfo.user.email);setFirstName(userInfo.user.givenName||undefined);thirdPartyInfoRef.current={id:userInfo.user.id,accessToken:userInfo.accessToken};}catch(error){_CommonToast.default.failError(error);}_Loading.default.hide();}),[googleSign]);var renderGoogleAccount=(0,_react.useCallback)(function(){return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_CommonText.TextM,{style:_style.pageStyles.accountLabel,__self:_this,__source:{fileName:_jsxFileName,lineNumber:452,columnNumber:9}},"Guardian Google"),account?_react.default.createElement(_reactNative.View,{style:_style.pageStyles.thirdPartAccount,__self:_this,__source:{fileName:_jsxFileName,lineNumber:454,columnNumber:11}},firstName&&_react.default.createElement(_CommonText.TextM,{style:_style.pageStyles.firstNameStyle,__self:_this,__source:{fileName:_jsxFileName,lineNumber:455,columnNumber:27}},firstName),_react.default.createElement(_CommonText.TextS,{style:[!!firstName&&_styles.FontStyles.font3],numberOfLines:1,__self:_this,__source:{fileName:_jsxFileName,lineNumber:456,columnNumber:13}},account)):_react.default.createElement(_Touchable.default,{onPress:onGoogleSign,__self:_this,__source:{fileName:_jsxFileName,lineNumber:461,columnNumber:11}},_react.default.createElement(_reactNative.View,{style:_style.pageStyles.oAuthBtn,__self:_this,__source:{fileName:_jsxFileName,lineNumber:462,columnNumber:13}},_react.default.createElement(_CommonText.TextM,{style:[_styles.FontStyles.font4,_fonts.default.mediumFont],__self:_this,__source:{fileName:_jsxFileName,lineNumber:463,columnNumber:15}},"Click Add Google Account"))));},[account,firstName,onGoogleSign]);var renderAppleAccount=(0,_react.useCallback)(function(){return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_CommonText.TextM,{style:_style.pageStyles.accountLabel,__self:_this,__source:{fileName:_jsxFileName,lineNumber:474,columnNumber:9}},"Guardian Info"),account?_react.default.createElement(_reactNative.View,{style:_style.pageStyles.thirdPartAccount,__self:_this,__source:{fileName:_jsxFileName,lineNumber:476,columnNumber:11}},firstName&&_react.default.createElement(_CommonText.TextM,{style:_style.pageStyles.firstNameStyle,__self:_this,__source:{fileName:_jsxFileName,lineNumber:477,columnNumber:27}},firstName),_react.default.createElement(_CommonText.TextS,{style:[!!firstName&&_styles.FontStyles.font3],numberOfLines:1,__self:_this,__source:{fileName:_jsxFileName,lineNumber:478,columnNumber:13}},account)):_react.default.createElement(_Touchable.default,{onPress:onAppleSign,__self:_this,__source:{fileName:_jsxFileName,lineNumber:483,columnNumber:11}},_react.default.createElement(_reactNative.View,{style:_style.pageStyles.oAuthBtn,__self:_this,__source:{fileName:_jsxFileName,lineNumber:484,columnNumber:13}},_react.default.createElement(_CommonText.TextM,{style:[_styles.FontStyles.font4,_fonts.default.mediumFont],__self:_this,__source:{fileName:_jsxFileName,lineNumber:485,columnNumber:15}},"Click Add Apple ID"))));},[account,firstName,onAppleSign]);var renderGuardianAccount=(0,_react.useCallback)(function(){if(!selectedType)return _react.default.createElement(_react.default.Fragment,null);switch(selectedType.value){case _wallet.LoginType.Email:return _react.default.createElement(_CommonInput.default,{disabled:false,type:"general",theme:"white-bg",label:t('Guardian email'),value:account,placeholder:t('Enter email'),onChangeText:onAccountChange,errorMessage:guardianTypeError.isError?guardianTypeError.errorMsg:'',keyboardType:"email-address",__self:_this,__source:{fileName:_jsxFileName,lineNumber:499,columnNumber:11}});case _wallet.LoginType.Phone:return _react.default.createElement(_PhoneInput.default,{label:t('Guardian Phone'),theme:"white-bg",value:account,onCountryChange:setCountry,navigateForResult:navigateForResult,errorMessage:guardianTypeError.isError?guardianTypeError.errorMsg:'',onChangeText:onAccountChange,selectCountry:country,__self:_this,__source:{fileName:_jsxFileName,lineNumber:513,columnNumber:11}});case _wallet.LoginType.Google:return renderGoogleAccount();case _wallet.LoginType.Apple:return renderAppleAccount();default:break;}return _react.default.createElement(_react.default.Fragment,null);},[account,country,guardianTypeError.errorMsg,guardianTypeError.isError,navigateForResult,onAccountChange,renderAppleAccount,renderGoogleAccount,selectedType,t]);return _react.default.createElement(_PageContainer.default,{safeAreaColor:['blue','gray'],titleDom:t('Add Guardians'),leftCallback:function leftCallback(){onFinish({status:'cancel'});},containerStyles:_style.pageStyles.pageWrap,scrollViewProps:{disabled:true},__self:_this,__source:{fileName:_jsxFileName,lineNumber:546,columnNumber:5}},_react.default.createElement(_reactNative.View,{style:_style.pageStyles.contentWrap,__self:_this,__source:{fileName:_jsxFileName,lineNumber:554,columnNumber:7}},_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_CommonText.TextM,{style:_style.pageStyles.titleLabel,__self:_this,__source:{fileName:_jsxFileName,lineNumber:556,columnNumber:11}},t('Guardian Type')),_react.default.createElement(_ListItem.default,{onPress:function onPress(){_GuardianTypeSelectOverlay.default.showList({list:_misc.LOGIN_TYPE_LIST,labelAttrName:'name',value:selectedType==null?void 0:selectedType.value,callBack:onChooseType});},titleStyle:[_GStyles.default.flexRowWrap,_GStyles.default.itemCenter],titleTextStyle:[_style.pageStyles.titleTextStyle,!selectedType&&_styles.FontStyles.font7],style:_style.pageStyles.typeWrap,titleLeftElement:(selectedType==null?void 0:selectedType.icon)&&_react.default.createElement(_Svg.default,{icon:selectedType.icon,size:(0,_unit.pTd)(28),iconStyle:_style.pageStyles.typeIcon,__self:_this,__source:{fileName:_jsxFileName,lineNumber:570,columnNumber:37}}),title:(selectedType==null?void 0:selectedType.name)||t('Select guardian types'),rightElement:_react.default.createElement(_Svg.default,{size:(0,_unit.pTd)(20),icon:"down-arrow",__self:_this,__source:{fileName:_jsxFileName,lineNumber:573,columnNumber:27}}),__self:_this,__source:{fileName:_jsxFileName,lineNumber:557,columnNumber:11}})),renderGuardianAccount(),_react.default.createElement(_CommonText.TextM,{style:_style.pageStyles.titleLabel,__self:_this,__source:{fileName:_jsxFileName,lineNumber:579,columnNumber:9}},t('Verifier')),_react.default.createElement(_ListItem.default,{onPress:function onPress(){_VerifierSelectOverlay.default.showList({id:selectedVerifier==null?void 0:selectedVerifier.id,labelAttrName:'name',list:verifierList,callBack:onChooseVerifier});},titleLeftElement:selectedVerifier&&_react.default.createElement(_VerifierImage.VerifierImage,{style:_style.pageStyles.verifierImageStyle,size:(0,_unit.pTd)(30),label:selectedVerifier.name,uri:selectedVerifier.imageUrl,__self:_this,__source:{fileName:_jsxFileName,lineNumber:591,columnNumber:15}}),titleStyle:[_GStyles.default.flexRowWrap,_GStyles.default.itemCenter],titleTextStyle:[_style.pageStyles.titleTextStyle,!selectedVerifier&&_styles.FontStyles.font7],style:_style.pageStyles.verifierWrap,title:(selectedVerifier==null?void 0:selectedVerifier.name)||t('Select guardian verifiers'),rightElement:_react.default.createElement(_Svg.default,{size:(0,_unit.pTd)(20),icon:"down-arrow",__self:_this,__source:{fileName:_jsxFileName,lineNumber:603,columnNumber:25}}),__self:_this,__source:{fileName:_jsxFileName,lineNumber:580,columnNumber:9}}),guardianError.isError&&_react.default.createElement(_CommonText.TextS,{style:_style.pageStyles.errorTips,__self:_this,__source:{fileName:_jsxFileName,lineNumber:605,columnNumber:35}},guardianError.errorMsg||'')),_react.default.createElement(_reactNative.View,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:607,columnNumber:7}},_react.default.createElement(_CommonButton.default,{disabled:isConfirmDisable,type:"primary",onPress:onConfirm,__self:_this,__source:{fileName:_jsxFileName,lineNumber:608,columnNumber:9}},t('Confirm'))));};var _default=exports.default=AddGuardian;