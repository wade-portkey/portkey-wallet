var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.UIManagerService=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _initializerDefineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/initializerDefineProperty"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _applyDecoratedDescriptor2=_interopRequireDefault(require("@babel/runtime/helpers/applyDecoratedDescriptor"));var _initializerWarningHelper2=_interopRequireDefault(require("@babel/runtime/helpers/initializerWarningHelper"));var _inversify=require("inversify");var _entries=require("../../config/entries");var _entries2=require("../../global/init/entries");var _nativeModules=require("../native-modules");var _types=require("../core/types");var _error=require("../error");var _dec,_dec2,_class,_class2,_descriptor;var UIManagerService=exports.UIManagerService=(_dec=(0,_inversify.injectable)(),_dec2=(0,_inversify.inject)(_types.TYPES.AccountModule),_dec(_class=(_class2=function(){function UIManagerService(){(0,_classCallCheck2.default)(this,UIManagerService);(0,_initializerDefineProperty2.default)(this,"_accountService",_descriptor,this);}(0,_createClass2.default)(UIManagerService,[{key:"login",value:function login(){var _this=this;return new Promise(function(resolve,reject){_this.openResultFromExternal(_entries.PortkeyEntries.SIGN_IN_ENTRY,function(res){if(res){var _res$data$walletInfo,_res$data;resolve((_res$data$walletInfo=res==null?void 0:(_res$data=res.data)==null?void 0:_res$data.walletInfo)!=null?_res$data$walletInfo:null);}else{reject(new _error.AccountError(1004));}});});}},{key:"openAssetsDashboard",value:function(){var _openAssetsDashboard=(0,_asyncToGenerator2.default)(function*(){if(!(yield this.checkIsUnlocked())){throw new _error.AccountError(1001);}this.openFromExternal(_entries.PortkeyEntries.ASSETS_HOME_ENTRY);});function openAssetsDashboard(){return _openAssetsDashboard.apply(this,arguments);}return openAssetsDashboard;}()},{key:"guardiansManager",value:function(){var _guardiansManager=(0,_asyncToGenerator2.default)(function*(){if(!(yield this.checkIsUnlocked())){throw new _error.AccountError(1001);}this.openFromExternal(_entries.PortkeyEntries.GUARDIAN_HOME_ENTRY);});function guardiansManager(){return _guardiansManager.apply(this,arguments);}return guardiansManager;}()},{key:"settingsManager",value:function(){var _settingsManager=(0,_asyncToGenerator2.default)(function*(){if(!(yield this.checkIsUnlocked())){throw new _error.AccountError(1001);}this.openFromExternal(_entries.PortkeyEntries.ACCOUNT_SETTING_ENTRY);});function settingsManager(){return _settingsManager.apply(this,arguments);}return settingsManager;}()},{key:"paymentSecurityManager",value:function(){var _paymentSecurityManager=(0,_asyncToGenerator2.default)(function*(){if(!(yield this.checkIsUnlocked())){throw new _error.AccountError(1001);}this.openFromExternal(_entries.PortkeyEntries.PAYMENT_SECURITY_HOME_ENTRY);});function paymentSecurityManager(){return _paymentSecurityManager.apply(this,arguments);}return paymentSecurityManager;}()},{key:"unlockWallet",value:function unlockWallet(){var _this2=this;return new Promise(function(resolve,reject){_this2.openResultFromExternal(_entries.PortkeyEntries.CHECK_PIN,function(res){if(res){var _res$data$walletInfo2,_res$data2;resolve((_res$data$walletInfo2=(_res$data2=res.data)==null?void 0:_res$data2.walletInfo)!=null?_res$data$walletInfo2:null);}else{reject(new _error.AccountError(1003));}});});}},{key:"checkIsUnlocked",value:function(){var _checkIsUnlocked=(0,_asyncToGenerator2.default)(function*(){var wallState=yield this._accountService.getWalletState();if(wallState!==_types.WalletState.UNLOCKED){console.warn("wallState state is error, wallet is not unlocked");}return wallState===_types.WalletState.UNLOCKED;});function checkIsUnlocked(){return _checkIsUnlocked.apply(this,arguments);}return checkIsUnlocked;}()},{key:"openFromExternal",value:function openFromExternal(target){_nativeModules.PortkeyModulesEntity.RouterModule.navigateTo(target,_entries2.LaunchModeSet.get(target)||_entries2.LaunchMode.STANDARD,'external','none',false,{});}},{key:"openResultFromExternal",value:function openResultFromExternal(target,callback){console.log('target',target);_nativeModules.PortkeyModulesEntity.RouterModule.navigateToWithOptions(target,_entries2.LaunchModeSet.get(target)||_entries2.LaunchMode.STANDARD,'external',{},callback);}}]);return UIManagerService;}(),(_descriptor=(0,_applyDecoratedDescriptor2.default)(_class2.prototype,"_accountService",[_dec2],{configurable:true,enumerable:true,writable:true,initializer:null})),_class2))||_class);