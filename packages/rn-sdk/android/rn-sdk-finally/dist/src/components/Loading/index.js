var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _react=_interopRequireDefault(require("react"));var _Overlay=_interopRequireDefault(require("rn-teaset/components/Overlay/Overlay"));var _reactNative=require("react-native");var _CommonText=require("../CommonText");var _theme=require("../../assets/theme");var _GStyles=_interopRequireDefault(require("../../assets/theme/GStyles"));var _lottieReactNative=_interopRequireDefault(require("lottie-react-native"));var _unit=require("../../utils/unit");var _jsxFileName="/Users/fengfeiyang/aelf/portkey-wallet/packages/rn-sdk/android/rn-sdk-finally/src/components/Loading/index.tsx";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}var elements=[];var timer=null;function LoadingBody(_ref){var text=_ref.text;return _react.default.createElement(_reactNative.View,{style:[_GStyles.default.center,styles.loadingWrap],__self:this,__source:{fileName:_jsxFileName,lineNumber:26,columnNumber:5}},_react.default.createElement(_lottieReactNative.default,{source:require("../../assets/lottieFiles/globalLoading.json"),style:styles.loadingStyle,autoPlay:true,loop:true,__self:this,__source:{fileName:_jsxFileName,lineNumber:27,columnNumber:7}}),_react.default.createElement(_CommonText.TextM,{style:styles.textStyles,__self:this,__source:{fileName:_jsxFileName,lineNumber:33,columnNumber:7}},text));}var Loading=exports.default=function(_React$Component){(0,_inherits2.default)(Loading,_React$Component);var _super=_createSuper(Loading);function Loading(){(0,_classCallCheck2.default)(this,Loading);return _super.apply(this,arguments);}(0,_createClass2.default)(Loading,[{key:"componentWillUnmount",value:function componentWillUnmount(){Loading.destroy();}}],[{key:"show",value:function show(options){var _ref2=options||{},_ref2$text=_ref2.text,text=_ref2$text===void 0?'Loading...':_ref2$text,_ref2$iconType=_ref2.iconType,iconType=_ref2$iconType===void 0?'loading':_ref2$iconType,_ref2$isMaskTranspare=_ref2.isMaskTransparent,isMaskTransparent=_ref2$isMaskTranspare===void 0?true:_ref2$isMaskTranspare,_ref2$overlayProps=_ref2.overlayProps,overlayProps=_ref2$overlayProps===void 0?{}:_ref2$overlayProps;_reactNative.Keyboard.dismiss();Loading.hide();var overlayView=_react.default.createElement(_Overlay.default.PopView,(0,_extends2.default)({modal:true,type:"zoomIn",style:[styles.container,isMaskTransparent&&styles.maskTransparent],overlayOpacity:0},overlayProps,{__self:this,__source:{fileName:_jsxFileName,lineNumber:44,columnNumber:7}}),_react.default.createElement(LoadingBody,{text:text,iconType:iconType,__self:this,__source:{fileName:_jsxFileName,lineNumber:50,columnNumber:9}}));var key=_Overlay.default.show(overlayView);elements.push(key);return key;}},{key:"showOnce",value:function showOnce(options){if(elements.length)return;Loading.show(options);}},{key:"hide",value:function hide(key){timer&&clearTimeout(timer);timer=null;elements=elements.filter(function(item){return item;});var keyItem;if(key!==undefined){keyItem=elements.find(function(item){return item===key;});elements=elements.filter(function(item){return item!==key;});}else{keyItem=elements.pop();}keyItem!==undefined&&_Overlay.default.hide(keyItem);}},{key:"destroy",value:function destroy(){timer&&clearTimeout(timer);timer=null;elements.forEach(function(item){return _Overlay.default.hide(item);});elements=[];}}]);return Loading;}(_react.default.Component);var styles=_reactNative.StyleSheet.create({container:{alignItems:'center',justifyContent:'center',backgroundColor:_theme.defaultColors.bg1},maskTransparent:{backgroundColor:'#00000030'},loadingWrap:{width:(0,_unit.pTd)(224),minHeight:(0,_unit.pTd)(120),padding:(0,_unit.pTd)(16),backgroundColor:_theme.defaultColors.bg1,borderRadius:(0,_unit.pTd)(6)},loadingStyle:{width:(0,_unit.pTd)(50)},textStyles:{color:_theme.defaultColors.font5,marginTop:(0,_unit.pTd)(10)}});