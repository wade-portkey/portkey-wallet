var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.useAmountInUsdShow=useAmountInUsdShow;exports.useFreshTokenPrice=useFreshTokenPrice;exports.useGetCurrentAccountTokenPrice=useGetCurrentAccountTokenPrice;exports.useIsTokenHasPrice=useIsTokenHasPrice;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _misc=require("../../constants/misc");var _slice=require("packages/types/store-ca/assets/slice");var _converter=require("../../utils/converter");var _react=require("react");var _=require("./..");var _network=require("./network");function useGetCurrentAccountTokenPrice(){var _useAppCASelector=(0,_.useAppCASelector)(function(state){return state.assets;}),tokenPriceObject=_useAppCASelector.tokenPrices.tokenPriceObject,accountToken=_useAppCASelector.accountToken;var dispatch=(0,_.useAppCommonDispatch)();var symbols=(0,_react.useMemo)(function(){var _accountToken$account;return Array.from(new Set(accountToken==null?void 0:(_accountToken$account=accountToken.accountTokenList)==null?void 0:_accountToken$account.map(function(item){return item.symbol;})));},[accountToken.accountTokenList]);var getTokenPrice=(0,_react.useCallback)(function(symbol){if(symbols.length===0)return;dispatch((0,_slice.fetchTokensPriceAsync)({symbols:symbol?[symbol]:symbols}));},[dispatch,symbols]);var getTokensPrice=(0,_react.useCallback)(function(symbols){dispatch((0,_slice.fetchTokensPriceAsync)({symbols:symbols}));},[dispatch]);return[tokenPriceObject,getTokenPrice,getTokensPrice];}function useFreshTokenPrice(){var _useAppCASelector2=(0,_.useAppCASelector)(function(state){return state.assets;}),accountToken=_useAppCASelector2.accountToken;var _useGetCurrentAccount=useGetCurrentAccountTokenPrice(),_useGetCurrentAccount2=(0,_slicedToArray2.default)(_useGetCurrentAccount,2),getTokenPrice=_useGetCurrentAccount2[1];var isMainnet=(0,_network.useIsMainnet)();var symbols=(0,_react.useMemo)(function(){var _accountToken$account2;return Array.from(new Set(accountToken==null?void 0:(_accountToken$account2=accountToken.accountTokenList)==null?void 0:_accountToken$account2.map(function(item){return item.symbol;})));},[accountToken.accountTokenList]);(0,_react.useEffect)(function(){if(isMainnet){getTokenPrice();}},[symbols,isMainnet]);}function useAmountInUsdShow(){var _useGetCurrentAccount3=useGetCurrentAccountTokenPrice(),_useGetCurrentAccount4=(0,_slicedToArray2.default)(_useGetCurrentAccount3,1),tokenPriceObject=_useGetCurrentAccount4[0];return(0,_react.useCallback)(function(balance,decimals,symbol){return tokenPriceObject[symbol]===0?'':"$ "+(0,_converter.formatAmountShow)((0,_converter.divDecimals)(balance,decimals).times(tokenPriceObject[symbol]),2);},[tokenPriceObject]);}function useIsTokenHasPrice(symbol){var _useAppCASelector3=(0,_.useAppCASelector)(function(state){return state.assets;}),tokenPriceObject=_useAppCASelector3.tokenPrices.tokenPriceObject;if(!symbol)return false;if(!tokenPriceObject[symbol])return false;return _misc.ZERO.plus(tokenPriceObject[symbol]).isGreaterThan(0);}