var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.getCachedNetworkConfig=exports.getCachedAllChainInfo=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _constants=require("../../global/constants");var _controller=require("../../network/controller");var _cache=require("../../service/storage/cache");var NETWORK_CONFIG_KEY='network_config_key';var getCachedNetworkConfig=exports.getCachedNetworkConfig=function(){var _ref=(0,_asyncToGenerator2.default)(function*(targetChainId){var chain=targetChainId||(yield _constants.PortkeyConfig.currChainId());return yield(0,_cache.handleCachedValue)({target:'TEMP',getIdentifier:function(){var _getIdentifier=(0,_asyncToGenerator2.default)(function*(){var portkeyEndPointUrl=yield _constants.PortkeyConfig.endPointUrl();return NETWORK_CONFIG_KEY+"#"+portkeyEndPointUrl+"#"+chain;});function getIdentifier(){return _getIdentifier.apply(this,arguments);}return getIdentifier;}(),getValueIfNonExist:function(){var _getValueIfNonExist=(0,_asyncToGenerator2.default)(function*(){var networkInfo=yield _controller.NetworkController.getNetworkInfo();var chainInfo=networkInfo.items.find(function(it){return it.chainId===chain;});if(!chainInfo)throw new Error('network failure');var config={peerUrl:chainInfo.endPoint,caContractAddress:chainInfo.caContractAddress,defaultToken:chainInfo.defaultToken};return config;});function getValueIfNonExist(){return _getValueIfNonExist.apply(this,arguments);}return getValueIfNonExist;}()});});return function getCachedNetworkConfig(_x){return _ref.apply(this,arguments);};}();var getCachedAllChainInfo=exports.getCachedAllChainInfo=function(){var _ref2=(0,_asyncToGenerator2.default)(function*(){return yield(0,_cache.handleCachedValue)({target:'TEMP',getIdentifier:function(){var _getIdentifier2=(0,_asyncToGenerator2.default)(function*(){var portkeyEndPointUrl=yield _constants.PortkeyConfig.endPointUrl();return NETWORK_CONFIG_KEY+"#"+portkeyEndPointUrl;});function getIdentifier(){return _getIdentifier2.apply(this,arguments);}return getIdentifier;}(),getValueIfNonExist:function(){var _getValueIfNonExist2=(0,_asyncToGenerator2.default)(function*(){var networkInfo=yield _controller.NetworkController.getNetworkInfo();var chainInfo=networkInfo.items;if(!chainInfo)throw new Error('network failure');return chainInfo;});function getValueIfNonExist(){return _getValueIfNonExist2.apply(this,arguments);}return getValueIfNonExist;}()});});return function getCachedAllChainInfo(){return _ref2.apply(this,arguments);};}();