var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _api=require("./api");var _react=require("@testing-library/react");var networkHooks=_interopRequireWildcard(require("./network"));var walletHooks=_interopRequireWildcard(require("./wallet"));var _aes=_interopRequireDefault(require("../../utils/aes"));var _aelfSdk=_interopRequireDefault(require("aelf-sdk"));var utils=_interopRequireWildcard(require("../../api/api-did/utils"));var _networkState=require("test/data/networkState");var _chainInfo=require("test/data/chainInfo");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n.default=e,t&&t.set(e,n),n;}describe('useRefreshTokenConfig',function(){beforeEach(function(){jest.restoreAllMocks();});test('no pin, and decrypt is not been called',function(){jest.spyOn(networkHooks,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(walletHooks,'useCurrentWalletInfo').mockReturnValue((0,_chainInfo.currentWallet)('TESTNET').walletInfo);jest.spyOn(walletHooks,'useOriginChainId').mockReturnValue('AELF');jest.spyOn(_aes.default,'decrypt').mockReturnValue('');(0,_react.act)(function(){return(0,_react.renderHook)(function(){return(0,_api.useRefreshTokenConfig)();});});expect(networkHooks.useCurrentNetworkInfo).toBeCalledTimes(1);expect(walletHooks.useCurrentWalletInfo).toBeCalledTimes(1);expect(walletHooks.useOriginChainId).toBeCalledTimes(1);expect(_aes.default.decrypt).toBeCalledTimes(0);});test('no privateKey, and getWalletByPrivateKey is not called',function(){jest.spyOn(networkHooks,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(walletHooks,'useCurrentWalletInfo').mockReturnValue((0,_chainInfo.currentWallet)('TESTNET').walletInfo);jest.spyOn(walletHooks,'useOriginChainId').mockReturnValue('AELF');jest.spyOn(_aes.default,'decrypt').mockReturnValue('');jest.spyOn(_aelfSdk.default.wallet,'getWalletByPrivateKey').mockReturnValue({});jest.spyOn(utils,'setRefreshTokenConfig').mockImplementation(jest.fn());(0,_react.renderHook)(function(){return(0,_api.useRefreshTokenConfig)('123456');});expect(_aes.default.decrypt).toBeCalledTimes(1);expect(_aelfSdk.default.wallet.getWalletByPrivateKey).toBeCalledTimes(0);expect(utils.setRefreshTokenConfig).toBeCalledTimes(0);});test('complete data, and all methods are called ',function(){jest.spyOn(networkHooks,'useCurrentNetworkInfo').mockReturnValue(_networkState.TestnetNetworkInfo);jest.spyOn(walletHooks,'useCurrentWalletInfo').mockReturnValue((0,_chainInfo.currentWallet)('TESTNET').walletInfo);jest.spyOn(walletHooks,'useOriginChainId').mockReturnValue('AELF');jest.spyOn(_aes.default,'decrypt').mockReturnValue('123...rgt');jest.spyOn(_aelfSdk.default.wallet,'getWalletByPrivateKey').mockReturnValue({});jest.spyOn(utils,'setRefreshTokenConfig').mockImplementation(jest.fn());(0,_react.renderHook)(function(){return(0,_api.useRefreshTokenConfig)('123456');});expect(_aes.default.decrypt).toBeCalledTimes(1);expect(_aelfSdk.default.wallet.getWalletByPrivateKey).toBeCalledTimes(1);expect(utils.setRefreshTokenConfig).toBeCalledTimes(1);});});