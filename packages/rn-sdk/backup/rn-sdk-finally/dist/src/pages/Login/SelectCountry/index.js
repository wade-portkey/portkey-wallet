var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=SelectCountry;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _device=require("../../../packages/utils/mobile/device");var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _Touchable=_interopRequireDefault(require("../../../components/Touchable"));var _PageContainer=_interopRequireDefault(require("../../../components/PageContainer"));var _country=require("../../../packages/constants/constants-ca/country");var _GStyles=_interopRequireDefault(require("../../../assets/theme/GStyles"));var _IndexBarLargeList=_interopRequireDefault(require("../../../components/CommonLargeList/IndexBarLargeList"));var _CommonInput=_interopRequireDefault(require("../../../components/CommonInput"));var _theme=require("../../../assets/theme");var _unit=require("../../../utils/unit");var _CommonText=require("../../../components/CommonText");var _styles=require("../../../assets/theme/styles");var _NoData=_interopRequireDefault(require("../../../components/NoData"));var _index=require("../../../components/CustomHeader/style/index.style");var _useEffectOnce=_interopRequireDefault(require("../../../hooks/useEffectOnce"));var _global=require("../../../model/global");var _storage=require("../../../service/storage");var _jsxFileName="/Users/fengfeiyang/aelf/portkey-wallet/packages/rn-sdk/android/rn-sdk-finally/src/pages/Login/SelectCountry/index.tsx";function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n.default=e,t&&t.set(e,n),n;}var IndexHeight=56,SectionHeight=20;function SelectCountry(_ref){var _this=this;var selectCountry=_ref.selectCountry,navigateBack=_ref.navigateBack;var _useState=(0,_react.useState)([]),_useState2=(0,_slicedToArray2.default)(_useState,2),phoneCountryCodeList=_useState2[0],setPhoneCountryCodeList=_useState2[1];var _useState3=(0,_react.useState)(),_useState4=(0,_slicedToArray2.default)(_useState3,2),List=_useState4[0],setList=_useState4[1];var _useState5=(0,_react.useState)(),_useState6=(0,_slicedToArray2.default)(_useState5,2),searchList=_useState6[0],setSearchList=_useState6[1];(0,_useEffectOnce.default)(function(){checkMMKVStorage();});var checkMMKVStorage=function(){var _ref2=(0,_asyncToGenerator2.default)(function*(){var _yield$getCachedCount;var countryCodeList=(_yield$getCachedCount=yield(0,_global.getCachedCountryCodeData)())==null?void 0:_yield$getCachedCount.data;setPhoneCountryCodeList(countryCodeList);var codeIndex=(0,_country.getCountryCodeIndex)(countryCodeList);var list=codeIndex.map(function(i){return{index:i[0],items:i[1]};});setList(list);});return function checkMMKVStorage(){return _ref2.apply(this,arguments);};}();var data=(0,_react.useMemo)(function(){return searchList||List;},[List,searchList]);var _renderItem=function _renderItem(_ref3){var section=_ref3.section,row=_ref3.row;var item;if(!data)return _react.default.createElement(_reactNative.View,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:51,columnNumber:23}});if('items'in data[section]){item=data[section].items[row];}else{item=data[row];}var isSelected=(selectCountry==null?void 0:selectCountry.code)===item.code;return _react.default.createElement(_Touchable.default,{style:[styles.itemRow,_GStyles.default.itemCenter,_GStyles.default.spaceBetween],onPress:function onPress(){_storage.GlobalStorage.set(_global.CURRENT_USING_COUNTRY_CODE,JSON.stringify(item));navigateBack(item);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:59,columnNumber:7}},_react.default.createElement(_CommonText.TextL,{style:isSelected?_styles.FontStyles.font4:null,__self:_this,__source:{fileName:_jsxFileName,lineNumber:65,columnNumber:9}},item.country),_react.default.createElement(_CommonText.TextM,{style:[_styles.FontStyles.font3,isSelected?_styles.FontStyles.font4:null],__self:_this,__source:{fileName:_jsxFileName,lineNumber:66,columnNumber:9}},"+ ",item.code));};var _renderSection=function _renderSection(index){if(!List)return _react.default.createElement(_reactNative.View,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:71,columnNumber:23}});var contact=List[index];return _react.default.createElement(_reactNative.View,{style:styles.sectionRow,__self:_this,__source:{fileName:_jsxFileName,lineNumber:74,columnNumber:7}},_react.default.createElement(_CommonText.TextL,{style:_styles.FontStyles.font7,__self:_this,__source:{fileName:_jsxFileName,lineNumber:75,columnNumber:9}},contact.index));};if(!data){return _react.default.createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:80,columnNumber:12}});}return _react.default.createElement(_PageContainer.default,{titleDom:"Country/Region",safeAreaColor:['blue','white'],containerStyles:styles.containerStyles,leftCallback:function leftCallback(){navigateBack(null);},scrollViewProps:{disabled:true},__self:this,__source:{fileName:_jsxFileName,lineNumber:83,columnNumber:5}},_react.default.createElement(_reactNative.View,{style:styles.inputContainerStyle,__self:this,__source:{fileName:_jsxFileName,lineNumber:91,columnNumber:7}},_react.default.createElement(_CommonInput.default,{placeholder:"Search countries and regions",type:"search",onChangeText:function onChangeText(s){return setSearchList(!s?undefined:(0,_country.countryCodeFilter)(s,phoneCountryCodeList));},__self:this,__source:{fileName:_jsxFileName,lineNumber:92,columnNumber:9}})),_react.default.createElement(_reactNative.View,{style:styles.indexBarRow,__self:this,__source:{fileName:_jsxFileName,lineNumber:98,columnNumber:7}},_react.default.createElement(_IndexBarLargeList.default,{data:data,renderItem:_renderItem,indexHeight:IndexHeight,indexBarBoxStyle:styles.indexBarBoxStyle,sectionHeight:searchList?0:SectionHeight,extraHeight:_index.headerHeight+_device.bottomBarHeight+120,renderSection:searchList?undefined:_renderSection,indexArray:searchList?undefined:data.map(function(item){return item.index;}),renderEmpty:function renderEmpty(){return _react.default.createElement(_NoData.default,{topDistance:64,noPic:true,message:'There is no search result.',__self:_this,__source:{fileName:_jsxFileName,lineNumber:110,columnNumber:30}});},__self:this,__source:{fileName:_jsxFileName,lineNumber:99,columnNumber:9}})));}var styles=_reactNative.StyleSheet.create({itemRow:{flexDirection:'row',height:IndexHeight,paddingLeft:(0,_unit.pTd)(20),paddingRight:(0,_unit.pTd)(40)},sectionRow:{paddingHorizontal:(0,_unit.pTd)(20),height:SectionHeight,backgroundColor:_theme.defaultColors.bg1},containerStyles:Object.assign({},_GStyles.default.paddingArg(10,0),{backgroundColor:_theme.defaultColors.bg1,height:'100%'}),inputContainerStyle:{marginBottom:20,paddingHorizontal:(0,_unit.pTd)(20)},indexBarBoxStyle:{},indexBarRow:{overflow:'hidden',flex:1}});