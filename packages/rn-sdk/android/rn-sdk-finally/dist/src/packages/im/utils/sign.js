var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.getVerifyData=void 0;var _aelfSdk=_interopRequireDefault(require("aelf-sdk"));var getVerifyData=exports.getVerifyData=function getVerifyData(account,caHash){if(!account.keyPair){throw new Error('no keyPair');}var message=""+Date.now();var hexMsg=_aelfSdk.default.utils.sha256(message);var signature=account.keyPair.sign(Buffer.from(hexMsg,'hex'),{canonical:true});if(signature.recoveryParam===null){throw new Error('no recoveryParam');}var signatureStr=[signature.r.toString('hex',64),signature.s.toString('hex',64),"0"+signature.recoveryParam.toString()].join('');return{message:message,signature:signatureStr,address:account.address,caHash:caHash};};