var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.useTokenPrices=exports.useSearchTokenList=exports.useNftCollections=exports.useAccountTokenBalanceList=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _useEffectOnce=_interopRequireDefault(require("../../hooks/useEffectOnce"));var _wallet=require("../wallet");var _controller=require("../../network/controller");var _react=require("react");var useTokenPrices=exports.useTokenPrices=function useTokenPrices(){var _useState=(0,_react.useState)([]),_useState2=(0,_slicedToArray2.default)(_useState,2),tokenPrices=_useState2[0],setTokenPrices=_useState2[1];(0,_useEffectOnce.default)((0,_asyncToGenerator2.default)(function*(){yield updateTokenPrices();}));var updateTokenPrices=function(){var _ref2=(0,_asyncToGenerator2.default)(function*(){var result=yield _controller.NetworkController.checkELFTokenPrice();result&&setTokenPrices(result.items);});return function updateTokenPrices(){return _ref2.apply(this,arguments);};}();return{tokenPrices:tokenPrices,updateTokenPrices:updateTokenPrices};};var useAccountTokenBalanceList=exports.useAccountTokenBalanceList=function useAccountTokenBalanceList(){var _useState3=(0,_react.useState)([]),_useState4=(0,_slicedToArray2.default)(_useState3,2),balanceList=_useState4[0],setBalanceList=_useState4[1];(0,_useEffectOnce.default)((0,_asyncToGenerator2.default)(function*(){yield updateBalanceList();}));var updateBalanceList=function(){var _ref4=(0,_asyncToGenerator2.default)(function*(){var _yield$getUnlockedWal=yield(0,_wallet.getUnlockedWallet)({getMultiCaAddresses:true}),multiCaAddresses=_yield$getUnlockedWal.multiCaAddresses;var result=yield _controller.NetworkController.fetchUserTokenBalance({maxResultCount:100,skipCount:0,caAddressInfos:Object.entries(multiCaAddresses).map(function(_ref5){var _ref6=(0,_slicedToArray2.default)(_ref5,2),chainId=_ref6[0],caAddress=_ref6[1];return{chainId:chainId,caAddress:caAddress};})});result&&setBalanceList(result.data);});return function updateBalanceList(){return _ref4.apply(this,arguments);};}();return{balanceList:balanceList,updateBalanceList:updateBalanceList};};var useNftCollections=exports.useNftCollections=function useNftCollections(){var _useState5=(0,_react.useState)([]),_useState6=(0,_slicedToArray2.default)(_useState5,2),nftCollections=_useState6[0],setNftCollections=_useState6[1];(0,_useEffectOnce.default)((0,_asyncToGenerator2.default)(function*(){yield updateNftCollections();}));var updateNftCollections=function(){var _ref8=(0,_asyncToGenerator2.default)(function*(config){var _ref9=config||{},symbol=_ref9.symbol,_ref9$skipCount=_ref9.skipCount,skipCount=_ref9$skipCount===void 0?0:_ref9$skipCount,_ref9$maxResultCount=_ref9.maxResultCount,maxResultCount=_ref9$maxResultCount===void 0?100:_ref9$maxResultCount;var _yield$getUnlockedWal2=yield(0,_wallet.getUnlockedWallet)({getMultiCaAddresses:true}),multiCaAddresses=_yield$getUnlockedWal2.multiCaAddresses;var caAddressInfos=Object.entries(multiCaAddresses).map(function(_ref10){var _ref11=(0,_slicedToArray2.default)(_ref10,2),chainId=_ref11[0],caAddress=_ref11[1];return{chainId:chainId,caAddress:caAddress};});var _yield$NetworkControl=yield _controller.NetworkController.fetchNetCollections({maxResultCount:maxResultCount,skipCount:skipCount,caAddressInfos:caAddressInfos}),data=_yield$NetworkControl.data;var item;if(symbol){item=yield _controller.NetworkController.fetchParticularNftItemList({maxResultCount:maxResultCount,skipCount:skipCount,caAddressInfos:caAddressInfos,symbol:symbol});}setNftCollections(data.map(function(it){return Object.assign({},JSON.parse(JSON.stringify(it)),{children:symbol===it.symbol?item.data.filter(function(one){return one.chainId===(it==null?void 0:it.chainId);}):[]});}));});return function updateNftCollections(_x){return _ref8.apply(this,arguments);};}();return{nftCollections:nftCollections,updateNftCollections:updateNftCollections};};var useSearchTokenList=exports.useSearchTokenList=function useSearchTokenList(){var _useState7=(0,_react.useState)([]),_useState8=(0,_slicedToArray2.default)(_useState7,2),tokenList=_useState8[0],setTokenList=_useState8[1];(0,_useEffectOnce.default)((0,_asyncToGenerator2.default)(function*(){yield updateTokensList();}));var updateTokensList=function(){var _ref13=(0,_asyncToGenerator2.default)(function*(){var result=yield _controller.NetworkController.searchTokenList();result&&setTokenList(result.items);});return function updateTokensList(){return _ref13.apply(this,arguments);};}();return{tokenList:tokenList,updateTokensList:updateTokensList};};